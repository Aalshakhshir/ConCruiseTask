import { Test, TestingModule } from '@nestjs/testing';
import { CsvModule, CsvParser } from 'nest-csv-parser';
import { AppController } from './app.controller';
import { AppService } from './app.service';

const matches = [
  {
    id: '30',
    name: 'Kissee Broun',
    locationLatitude: '18.3999996',
    locationLongitude: '121.5166702',
    numberOfRides: '23',
    rating: '4.4',
    points: 9,
    driverName: "Lory O'Shirine",
  },
  {
    id: '39',
    name: 'Elysha Prop',
    locationLatitude: '59.3525393',
    locationLongitude: '18.0191452',
    numberOfRides: '77',
    rating: '3.6',
    points: 9,
    driverName: 'Lydia Pinnijar',
  },
  {
    id: '5',
    name: 'Nessy Stanway',
    locationLatitude: '31.2303904',
    locationLongitude: '121.4737021',
    numberOfRides: '46',
    rating: '3.7',
    points: 7,
    driverName: 'Adrea Veryan',
  },
  {
    id: '7',
    name: 'Harriette Adnam',
    locationLatitude: '49.3967841',
    locationLongitude: '14.4813772',
    numberOfRides: '25',
    rating: '3.6',
    points: 7,
    driverName: 'Dene Pendlebery',
  },
  {
    id: '9',
    name: 'Alfy Noell',
    locationLatitude: '53.5483785',
    locationLongitude: '10.078217',
    numberOfRides: '70',
    rating: '3.6',
    points: 7,
    driverName: 'Nikolas Attrill',
  },
  {
    id: '13',
    name: 'Tiphany Patrick',
    locationLatitude: '23.791187',
    locationLongitude: '112.299103',
    numberOfRides: '38',
    rating: '3.6',
    points: 7,
    driverName: 'Minne Worland',
  },
  {
    id: '25',
    name: 'Ondrea Watson',
    locationLatitude: '16.5347882',
    locationLongitude: '97.6032892',
    numberOfRides: '55',
    rating: '3.6',
    points: 7,
    driverName: 'Olimpia Miles',
  },
  {
    id: '26',
    name: 'Candice Sabati',
    locationLatitude: '40.105193',
    locationLongitude: '124.3602631',
    numberOfRides: '43',
    rating: '4.9',
    points: 7,
    driverName: 'Bebe Gaishson',
  },
  {
    id: '29',
    name: 'Henri Rosentholer',
    locationLatitude: '27.517896',
    locationLongitude: '109.213644',
    numberOfRides: '83',
    rating: '3.5',
    points: 7,
    driverName: 'Bethena Swynley',
  },
  {
    id: '36',
    name: 'Saudra Patience',
    locationLatitude: '29.181201',
    locationLongitude: '110.138102',
    numberOfRides: '17',
    rating: '3.9',
    points: 7,
    driverName: 'Benedetta Boggon',
  },
  {
    id: '6',
    name: 'Artie Ovey',
    locationLatitude: '-33.047238',
    locationLongitude: '-71.6126885',
    numberOfRides: '77',
    rating: '4.6',
    points: 5,
    driverName: 'Carmine Sutherington',
  },
  {
    id: '24',
    name: 'Muffin Gemson',
    locationLatitude: '44.9688472',
    locationLongitude: '-93.1315648',
    numberOfRides: '18',
    rating: '5',
    points: 5,
    driverName: 'Ardys Kisby',
  },
  {
    id: '18',
    name: 'Nessi Basezzi',
    locationLatitude: '42.3521585',
    locationLongitude: '44.6875131',
    numberOfRides: '53',
    rating: '3.6',
    points: 3,
    driverName: 'Cam Wolpert',
  },
  {
    id: '2',
    name: 'Carolus Boddis',
    locationLatitude: '27.950753',
    locationLongitude: '109.592921',
    numberOfRides: '99',
    rating: '3.6',
    points: 2,
    driverName: 'Gregoor Ostrich',
  },
  {
    id: '8',
    name: 'Anastassia Shepherdson',
    locationLatitude: '48.7700185',
    locationLongitude: '2.3508225',
    numberOfRides: '97',
    rating: '3.8',
    points: 2,
    driverName: 'Hersch Greiser',
  },
  {
    id: '12',
    name: 'Correna Vella',
    locationLatitude: '8.0093062',
    locationLongitude: '-62.4015536',
    numberOfRides: '49',
    rating: '4',
    points: 2,
    driverName: 'Cully Gatty',
  },
  {
    id: '17',
    name: 'Lilith Budnk',
    locationLatitude: '54.7180477',
    locationLongitude: '18.4086339',
    numberOfRides: '27',
    rating: '4.9',
    points: 2,
    driverName: 'Giorgio Ladyman',
  },
  {
    id: '20',
    name: 'Tabb Waring',
    locationLatitude: '36.854929',
    locationLongitude: '114.503339',
    numberOfRides: '97',
    rating: '4.6',
    points: 2,
    driverName: 'Blinnie Gadney',
  },
  {
    id: '21',
    name: 'Yelena Goodspeed',
    locationLatitude: '50.810462',
    locationLongitude: '16.2478969',
    numberOfRides: '81',
    rating: '3.7',
    points: 2,
    driverName: 'Oberon Le - Count',
  },
  {
    id: '31',
    name: 'Gunter Brimmacombe',
    locationLatitude: '59.2421439',
    locationLongitude: '14.2330452',
    numberOfRides: '91',
    rating: '4.3',
    points: 2,
    driverName: 'Jana Marley',
  },
  {
    id: '32',
    name: 'Louie Lattie',
    locationLatitude: '46.176012',
    locationLongitude: '129.425798',
    numberOfRides: '55',
    rating: '4.7',
    points: 2,
    driverName: 'Glory Sprigings',
  },
  {
    id: '34',
    name: 'Jori Wrangle',
    locationLatitude: '10.3187555',
    locationLongitude: '123.906446',
    numberOfRides: '30',
    rating: '4.6',
    points: 2,
    driverName: 'Sandie Godding',
  },
  {
    id: '38',
    name: 'Joli Maffi',
    locationLatitude: '39.2476884',
    locationLongitude: '21.1614231',
    numberOfRides: '9',
    rating: '4.4',
    points: 2,
    driverName: 'Titos Blastock',
  },
  {
    id: '1',
    name: 'Sybyl Coxwell',
    locationLatitude: '67.1356306',
    locationLongitude: '20.6831751',
    numberOfRides: '35',
    rating: '3.5',
    points: 0,
    driverName: 'Kristi Enser',
  },
  {
    id: '3',
    name: 'Sunny Beak',
    locationLatitude: '55.813957',
    locationLongitude: '37.626119',
    numberOfRides: '52',
    rating: '3.7',
    points: 0,
    driverName: 'Damaris Cathel',
  },
  {
    id: '4',
    name: 'Gracie Frunks',
    locationLatitude: '7.833333',
    locationLongitude: '-11.666667',
    numberOfRides: '67',
    rating: '3.5',
    points: 0,
    driverName: 'Matthieu Stokes',
  },
  {
    id: '10',
    name: 'Cory Crudge',
    locationLatitude: '22.791223',
    locationLongitude: '110.454459',
    numberOfRides: '18',
    rating: '3.9',
    points: 0,
    driverName: 'Vanny Paulus',
  },
  {
    id: '11',
    name: 'Jaymie Ware',
    locationLatitude: '57.1770444',
    locationLongitude: '26.0336703',
    numberOfRides: '78',
    rating: '4.1',
    points: 0,
    driverName: 'Reid Blyden',
  },
  {
    id: '14',
    name: 'Nata Carvill',
    locationLatitude: '-4.8149897',
    locationLongitude: '-38.1054495',
    numberOfRides: '63',
    rating: '3.7',
    points: 0,
    driverName: 'Gordon Ramm',
  },
  {
    id: '15',
    name: 'Rutger Haysom',
    locationLatitude: '-10.5792295',
    locationLongitude: '-37.745028',
    numberOfRides: '53',
    rating: '3.8',
    points: 0,
    driverName: 'Therine Roscoe',
  },
  {
    id: '16',
    name: 'Roseanne Riguard',
    locationLatitude: '-10.5732996',
    locationLongitude: '-38.4429274',
    numberOfRides: '40',
    rating: '4.3',
    points: 0,
    driverName: 'Pebrook Wellesley',
  },
  {
    id: '19',
    name: 'Terrie Larwell',
    locationLatitude: '52.1662684',
    locationLongitude: '109.7765741',
    numberOfRides: '12',
    rating: '4.5',
    points: 0,
    driverName: 'Lucilia Bellinger',
  },
  {
    id: '22',
    name: 'Almire Sutlieff',
    locationLatitude: '9.5113187',
    locationLongitude: '-75.3761952',
    numberOfRides: '36',
    rating: '4',
    points: 0,
    driverName: 'Esme Stenett',
  },
  {
    id: '23',
    name: 'Derek Paley',
    locationLatitude: '28.213424',
    locationLongitude: '116.429948',
    numberOfRides: '64',
    rating: '4.2',
    points: 0,
    driverName: 'Free Lang',
  },
  {
    id: '27',
    name: 'Fania Kadwallider',
    locationLatitude: '50.6999479',
    locationLongitude: '13.8459307',
    numberOfRides: '42',
    rating: '4.2',
    points: 0,
    driverName: 'Willie Baty',
  },
  {
    id: '28',
    name: 'Hali Johnsey',
    locationLatitude: '49.2809997',
    locationLongitude: '17.876832',
    numberOfRides: '83',
    rating: '3.8',
    points: 0,
    driverName: 'Antonina Cogan',
  },
  {
    id: '33',
    name: 'Ardath Mundie',
    locationLatitude: '41.7721061',
    locationLongitude: '-72.7038047',
    numberOfRides: '47',
    rating: '3.5',
    points: 0,
    driverName: 'Gaylor Ricardon',
  },
  {
    id: '35',
    name: 'Donavon Buckston',
    locationLatitude: '59.954927',
    locationLongitude: '40.2195978',
    numberOfRides: '23',
    rating: '3.7',
    points: 0,
    driverName: 'Tracey Yeomans',
  },
  {
    id: '37',
    name: 'Nicola Masser',
    locationLatitude: '19.4102526',
    locationLongitude: '-99.0073673',
    numberOfRides: '80',
    rating: '3.6',
    points: 0,
    driverName: 'Jacquelynn Greswell',
  },
  {
    id: '40',
    name: 'Meggie Illston',
    locationLatitude: '40.3779093',
    locationLongitude: '-7.8440342',
    numberOfRides: '26',
    rating: '3.8',
    points: 0,
    driverName: 'Jocelyne Benettini',
  },
];

const failed = [
  {
    id: '1',
    name: 'Sybyl Coxwell',
    locationLatitude: '67.1356306',
    locationLongitude: '20.6831751',
    numberOfRides: '35',
    rating: '3.5',
    points: 0,
    driverName: 'Kristi Enser',
  },
  {
    id: '3',
    name: 'Sunny Beak',
    locationLatitude: '55.813957',
    locationLongitude: '37.626119',
    numberOfRides: '52',
    rating: '3.7',
    points: 0,
    driverName: 'Damaris Cathel',
  },
  {
    id: '4',
    name: 'Gracie Frunks',
    locationLatitude: '7.833333',
    locationLongitude: '-11.666667',
    numberOfRides: '67',
    rating: '3.5',
    points: 0,
    driverName: 'Matthieu Stokes',
  },
  {
    id: '10',
    name: 'Cory Crudge',
    locationLatitude: '22.791223',
    locationLongitude: '110.454459',
    numberOfRides: '18',
    rating: '3.9',
    points: 0,
    driverName: 'Vanny Paulus',
  },
  {
    id: '11',
    name: 'Jaymie Ware',
    locationLatitude: '57.1770444',
    locationLongitude: '26.0336703',
    numberOfRides: '78',
    rating: '4.1',
    points: 0,
    driverName: 'Reid Blyden',
  },
  {
    id: '14',
    name: 'Nata Carvill',
    locationLatitude: '-4.8149897',
    locationLongitude: '-38.1054495',
    numberOfRides: '63',
    rating: '3.7',
    points: 0,
    driverName: 'Gordon Ramm',
  },
  {
    id: '15',
    name: 'Rutger Haysom',
    locationLatitude: '-10.5792295',
    locationLongitude: '-37.745028',
    numberOfRides: '53',
    rating: '3.8',
    points: 0,
    driverName: 'Therine Roscoe',
  },
  {
    id: '16',
    name: 'Roseanne Riguard',
    locationLatitude: '-10.5732996',
    locationLongitude: '-38.4429274',
    numberOfRides: '40',
    rating: '4.3',
    points: 0,
    driverName: 'Pebrook Wellesley',
  },
  {
    id: '19',
    name: 'Terrie Larwell',
    locationLatitude: '52.1662684',
    locationLongitude: '109.7765741',
    numberOfRides: '12',
    rating: '4.5',
    points: 0,
    driverName: 'Lucilia Bellinger',
  },
  {
    id: '22',
    name: 'Almire Sutlieff',
    locationLatitude: '9.5113187',
    locationLongitude: '-75.3761952',
    numberOfRides: '36',
    rating: '4',
    points: 0,
    driverName: 'Esme Stenett',
  },
  {
    id: '23',
    name: 'Derek Paley',
    locationLatitude: '28.213424',
    locationLongitude: '116.429948',
    numberOfRides: '64',
    rating: '4.2',
    points: 0,
    driverName: 'Free Lang',
  },
  {
    id: '27',
    name: 'Fania Kadwallider',
    locationLatitude: '50.6999479',
    locationLongitude: '13.8459307',
    numberOfRides: '42',
    rating: '4.2',
    points: 0,
    driverName: 'Willie Baty',
  },
  {
    id: '28',
    name: 'Hali Johnsey',
    locationLatitude: '49.2809997',
    locationLongitude: '17.876832',
    numberOfRides: '83',
    rating: '3.8',
    points: 0,
    driverName: 'Antonina Cogan',
  },
  {
    id: '33',
    name: 'Ardath Mundie',
    locationLatitude: '41.7721061',
    locationLongitude: '-72.7038047',
    numberOfRides: '47',
    rating: '3.5',
    points: 0,
    driverName: 'Gaylor Ricardon',
  },
  {
    id: '35',
    name: 'Donavon Buckston',
    locationLatitude: '59.954927',
    locationLongitude: '40.2195978',
    numberOfRides: '23',
    rating: '3.7',
    points: 0,
    driverName: 'Tracey Yeomans',
  },
  {
    id: '37',
    name: 'Nicola Masser',
    locationLatitude: '19.4102526',
    locationLongitude: '-99.0073673',
    numberOfRides: '80',
    rating: '3.6',
    points: 0,
    driverName: 'Jacquelynn Greswell',
  },
  {
    id: '40',
    name: 'Meggie Illston',
    locationLatitude: '40.3779093',
    locationLongitude: '-7.8440342',
    numberOfRides: '26',
    rating: '3.8',
    points: 0,
    driverName: 'Jocelyne Benettini',
  },
];

describe('AppController', () => {
  let appController: AppController;

  beforeEach(async () => {
    const app: TestingModule = await Test.createTestingModule({
      imports: [CsvModule],
      controllers: [AppController],
      providers: [AppService],
    }).compile();

    appController = app.get<AppController>(AppController);
  });

  describe('root', () => {
    it('should return the matching', () => {
      expect(appController.getBestRides()).toEqual(matches);
    });
    it('should get all failed rides', async () => {
      expect(await appController.getFailedRides()).toEqual(failed);
    });
  });
});
